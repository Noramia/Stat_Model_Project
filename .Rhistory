setwd("C:/Users/Oliver/OneDrive/Documents/2018/Semester 1/Statistical Modelling/Project")
library(broom)
library(MASS)
library(magrittr)
library(dplyr)
# ---- Data Entry and Cleaning ----
#reading data and removing '?' values:
mammo <- read.csv("mammo.txt", header=TRUE, na.strings = "?")
mammo <- dplyr::select(mammo, Age, Shape, Margin, Density, Severity)
#checking variable types and converting
str(mammo)
mammo$Shape <- as.factor(mammo$Shape)
mammo$Margin <- as.factor(mammo$Margin)
mammo$Density <- as.factor(mammo$Density)
mammo$Severity <- as.factor(mammo$Severity)
T1 <- glm(Severity ~ (Age + Shape + Margin + Density)^2, data = mammo, family = "binomial")
back.glm <- T1
back2.glm <- T1
summary(back2.glm)
back2.glm <- update(back2.glm, .~. - Margin:Density)
summary(back2.glm)
back2.glm <- update(back2.glm, .~. - Shape:Density)
summary(back2.glm)
back2.glm <- update(back2.glm, .~. - Age:Margin)
summary(back2.glm)
back2.glm <- update(back2.glm, .~. - Shape:Margin)
summary(back2.glm)
back2.glm <- update(back2.glm, .~. - Age:Density)
summary(back2.glm)
back2.glm <- update(back2.glm, .~. - Age:Shape)
back2.glm <- update(back2.glm, .~. - Age:Shape)
summary(back2.glm)
back2.glm <- update(back2.glm, .~. - Density)
summary(back2.glm)
setwd("~/GitHub/Stat_Model_Project")
?corrplot
library(corrplot)
?help
?corrplot
final.glm <- back2.glm
View(final.glm)
summary(back2.glm)
probabilities <- fitted(final.glm)
summary(probabilities)
probs
probabilities
boxplot(probs ~ newMammo$Shape)
boxplot(probabilities ~ newMammo$Shape)
newMammo <- mammo %>% select(Age, Margin, Shape, Severity)
newMammo <- na.omit(newMammo)
boxplot(probabilities ~ newMammo$Shape)
boxplot(probabilities ~ newMammo$Margin)
plot(probs ~ newMammo$Age)
plot(probabilities ~ newMammo$Age)
boxplot(probabilities ~ newMammo$Shape)
boxplot(probabilities ~ newMammo$Margin)
predict(final.glm,data.frame(Age=40,Shape="1",Margin="1"), type = "response")
predict(final.glm,data.frame(Age=40,Shape="1",Margin="1", Density = "1"), type = "response")
predict(final.glm,data.frame(Age=40,Shape="1",Margin="1", Density = "2"), type = "response")
predict(final.glm,data.frame(Age=40,Shape="1",Margin="1", Density = "3"), type = "response")
predict(final.glm,data.frame(Age=80,Shape="4",Margin="5"), type = "response")
predict(final.glm,data.frame(Age=60,Shape="2",Margin="3"), type = "response")
hist(probs)
hist(probabilities)
newMammo <- mammo %>% select(Age, Margin, Shape, Severity)
newMammo <- na.omit(newMammo)
install.packages("GGally")
